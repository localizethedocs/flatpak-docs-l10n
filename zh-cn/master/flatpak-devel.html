<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="./">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Flatpak as a developer platform" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.flatpak.org/en/flatpak-devel.html" />
<meta property="og:site_name" content="Flatpak" />
<meta property="og:description" content="This sections contains an overview on how Flatpak can be used as part of a developer workflow. CI Integration: Flatpak can be integrated with the CI pipelines and bundles can be produced as artifac..." />
<meta property="og:image:width" content="1146" />
<meta property="og:image:height" content="600" />
<meta property="og:image" content="https://docs.flatpak.org/en/latest/_images/social_previews/summary_flatpak-devel_47033a05.png" />
<meta property="og:image:alt" content="This sections contains an overview on how Flatpak can be used as part of a developer workflow. CI Integration: Flatpak can be integrated with the CI pipelines and bundles can be produced as artifac..." />
<meta name="description" content="This sections contains an overview on how Flatpak can be used as part of a developer workflow. CI Integration: Flatpak can be integrated with the CI pipelines and bundles can be produced as artifac..." />
<meta name="twitter:card" content="summary_large_image" />
<link rel="index" title="索引" href="genindex.html"><link rel="search" title="搜索" href="search.html"><link rel="next" title="Tips and Tricks" href="tips-and-tricks.html"><link rel="prev" title="Portal support in GTK" href="portals.html">
        <link rel="canonical" href="https://projects.localizethedocs.org/flatpak-docs-l10n/flatpak-devel.html">

    <link rel="shortcut icon" href="_static/favicon.ico"><!-- Generated with Sphinx 8.1.3 and Furo 2025.09.25 -->
        <title>Flatpak as a developer platform - Flatpak 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="_static/xdg.css?v=d059aca2" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style>

<script type="text/javascript" src="ltd-provenance.js"></script>
<script type="text/javascript" src="ltd-current.js"></script>
<script type="text/javascript" src="../../ltd-config.js"></script>
<script type="text/javascript" src="../../ltd-flyout.js"></script>
</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Flatpak  文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <span class="sidebar-brand-text">Flatpak  文档</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to Flatpak</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="getting-started.html">Getting Started</a><input aria-label="Toggle navigation of Getting Started" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="basic-concepts.html">Basic concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="using-flatpak.html">Using Flatpak</a></li>
<li class="toctree-l2"><a class="reference internal" href="first-build.html">Building your first Flatpak</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="building.html">Building</a><input aria-label="Toggle navigation of Building" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="building-introduction.html">Building Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="conventions.html">Requirements &amp; Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="dependencies.html">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="flatpak-builder.html">Flatpak Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="manifests.html">Manifests</a></li>
<li class="toctree-l2"><a class="reference internal" href="module-sources.html">Module Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="sandbox-permissions.html">Sandbox Permissions</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="guides.html">Guides</a><input aria-label="Toggle navigation of Guides" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="python.html">Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="electron.html">Electron</a></li>
<li class="toctree-l3"><a class="reference internal" href="dotnet.html">Dotnet</a></li>
<li class="toctree-l3"><a class="reference internal" href="qt.html">Qt</a></li>
<li class="toctree-l3"><a class="reference internal" href="multiarch.html">Multiarch support</a></li>
<li class="toctree-l3"><a class="reference internal" href="extension.html">Extensions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="publishing.html">Publishing</a><input aria-label="Toggle navigation of Publishing" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="repositories.html">Repositories</a></li>
<li class="toctree-l2"><a class="reference internal" href="hosting-a-repository.html">Hosting a repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="single-file-bundles.html">Single-file bundles</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb-drives.html">USB Drives</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="desktop-integration.html">Desktop Integration</a><input aria-label="Toggle navigation of Desktop Integration" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="portals.html">Portal support in GTK</a></li>
<li class="toctree-l2"><a class="reference internal" href="portals.html#portal-support-in-qt-and-kde">Portal support in Qt and KDE</a></li>
</ul>
</li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Flatpak as a developer platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="tips-and-tricks.html">Tips and Tricks</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="reference.html">Reference Documentation</a><input aria-label="Toggle navigation of Reference Documentation" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="flatpak-command-reference.html">Flatpak Command Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="flatpak-builder-command-reference.html">Flatpak Builder Command Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="available-runtimes.html">Available Runtimes</a></li>
<li class="toctree-l2"><a class="reference internal" href="under-the-hood.html">Under the Hood</a></li>
<li class="toctree-l2"><a class="reference internal" href="libflatpak-api-reference.html">libflatpak API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="portal-api-reference.html">Portal API Reference</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/flatpak/flatpak-docs/blob/master/docs/flatpak-devel.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/flatpak/flatpak-docs/edit/master/docs/flatpak-devel.rst" rel="edit" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="flatpak-as-a-developer-platform">
<h1>Flatpak as a developer platform<a class="headerlink" href="#flatpak-as-a-developer-platform" title="Link to this heading">🔗</a></h1>
<p>This sections contains an overview on how Flatpak can be used as part
of a developer workflow.</p>
<section id="ci-integration">
<h2>CI Integration<a class="headerlink" href="#ci-integration" title="Link to this heading">🔗</a></h2>
<p>Flatpak can be integrated with the CI pipelines and bundles can be
produced as artifacts for quick testing or it can be exported to a
Flatpak repository on a webserver to provide a Nightly Flatpak package.</p>
<p>The CI setup will vary based on the code host and the CI service being
used. A basic workflow for exporting to Gitlab pages is provided in
<a class="reference internal" href="hosting-a-repository.html"><span class="doc">Hosting a repository</span></a> which can be used as a starting point.</p>
<p><a class="reference external" href="https://gitlab.gnome.org/GNOME/Initiatives/-/wikis/DevOps-with-Flatpak#basic-ci">GNOME</a>
and <a class="reference external" href="https://develop.kde.org/docs/packaging/flatpak/publishing/#publishing-to-kdes-nightly-repositories">KDE</a>
also has their own respective CI setup for doing this, which can be
also be used for inspiration.</p>
<p><a class="reference external" href="https://github.com/flathub-infra/flatpak-github-actions">Flatpak Github Actions</a>
can be used for GitHub.</p>
</section>
<section id="running-tests">
<h2>Running tests<a class="headerlink" href="#running-tests" title="Link to this heading">🔗</a></h2>
<p>Flatpak Builder can also run tests with <code class="docutils literal notranslate"><span class="pre">run-tests,</span> <span class="pre">test-rule,</span> <span class="pre">test-commands,</span> <span class="pre">test-args</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">run-tests:</span> <span class="pre">true</span></code> in a module will run tests for that module after
installing.</p>
<p><code class="docutils literal notranslate"><span class="pre">test-rule</span></code> is the default target to build when running tests. For
<code class="docutils literal notranslate"><span class="pre">meson</span></code> an <code class="docutils literal notranslate"><span class="pre">cmake-ninja</span></code> buildsystems it defaults to <code class="docutils literal notranslate"><span class="pre">test</span></code>,
otherwise <code class="docutils literal notranslate"><span class="pre">check</span></code> for <code class="docutils literal notranslate"><span class="pre">cmake</span></code> and <code class="docutils literal notranslate"><span class="pre">autotools</span></code>. Setting it to an
empty string like <code class="docutils literal notranslate"><span class="pre">test-rule:</span> <span class="pre">''</span></code> will disable the target.</p>
<p><code class="docutils literal notranslate"><span class="pre">test-commands</span></code> is an array of additional commands that will be run
during tests.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">run-tests</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">test-rule</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="nt">test-commands</span><span class="p">:</span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xvfb-run tests/test_foo</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">test-args</span></code> is used to provide finish-args for tests. These do not
affect the normal installation.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">build-options</span><span class="p">:</span>
<span class="w">    </span><span class="nt">test-args</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;--socket=x11&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;--share=network&quot;</span>
</pre></div>
</div>
</section>
<section id="parallel-nightly-and-stable-applications">
<h2>Parallel nightly and stable applications<a class="headerlink" href="#parallel-nightly-and-stable-applications" title="Link to this heading">🔗</a></h2>
<p>In general stable and nightly versions or any two parallel branches
of an application should have different application IDs. This prevents many
potential conflicts such as incompatible configuration files or
overlapping well-known D-Bus names. This is mandatory if the application
uses its own well-known D-Bus name.</p>
<p>A standard way is to use the <code class="docutils literal notranslate"><span class="pre">.Devel</span></code> suffix to the original Flatpak ID.
The internal application ID, appstream ID, launchable, icon tags,
icon files, desktop files, Dbus service names etc. must follow the new
Flatpak ID for everything to work seamlessly for the user.</p>
<p>This can be integrated with buildsystem <cite>profiles</cite>, so simply building
with <code class="docutils literal notranslate"><span class="pre">-Dprofile=Devel</span></code> for example will build the Nightly application
and the default will build the stable appliction.</p>
<section id="buildsystem-handling">
<h3>Buildsystem handling<a class="headerlink" href="#buildsystem-handling" title="Link to this heading">🔗</a></h3>
<p>This is an example for the Meson buildsystem.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">src</span></code> subdirectory will contain the main source code of the
application and <code class="docutils literal notranslate"><span class="pre">data</span></code> subdirectory will have application metadata
such as desktop file, metainfo file, icons and the <code class="docutils literal notranslate"><span class="pre">po</span></code> subdirectory
will have translation files.</p>
<p>The root <code class="docutils literal notranslate"><span class="pre">meson.build</span></code> parts should be something like this:</p>
<div class="highlight-meson notranslate"><div class="highlight"><pre><span></span><span class="n">i18n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">import</span><span class="p">(</span><span class="s">&#39;i18n&#39;</span><span class="p">)</span>

<span class="n">profile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">get_option</span><span class="p">(</span><span class="s">&#39;profile&#39;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&#39;development&#39;</span>
<span class="w">  </span><span class="n">application_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;org.example.coolapp.Devel&#39;</span>
<span class="k">else</span>
<span class="w">  </span><span class="n">application_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;org.example.coolapp&#39;</span>
<span class="k">endif</span>

<span class="n">config_h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">configuration_data</span><span class="p">()</span>
<span class="n">config_h</span><span class="p">.</span><span class="n">set_quoted</span><span class="p">(</span><span class="s">&#39;APPLICATION_ID&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">application_id</span><span class="p">)</span>
<span class="n">config_h</span><span class="p">.</span><span class="n">set_quoted</span><span class="p">(</span><span class="s">&#39;PROFILE&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">profile</span><span class="p">)</span>
<span class="n">config_h</span><span class="p">.</span><span class="n">set_quoted</span><span class="p">(</span><span class="s">&#39;GETTEXT_PACKAGE&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;coolapp&#39;</span><span class="p">)</span>
<span class="n">config_h</span><span class="p">.</span><span class="n">set_quoted</span><span class="p">(</span><span class="s">&#39;PACKAGE_VERSION&#39;</span><span class="p">,</span><span class="w"> </span><span class="vm">meson</span><span class="p">.</span><span class="n">project_version</span><span class="p">())</span>
<span class="nb">configure_file</span><span class="p">(</span>
<span class="w">   </span><span class="n">output</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;config.h&#39;</span><span class="p">,</span>
<span class="w">   </span><span class="n">configuration</span><span class="p">:</span><span class="w"> </span><span class="n">config_h</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">configuration_inc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">include_directories</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)</span>

<span class="nb">subdir</span><span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">)</span>
<span class="nb">subdir</span><span class="p">(</span><span class="s">&#39;src&#39;</span><span class="p">)</span>
<span class="nb">subdir</span><span class="p">(</span><span class="s">&#39;po&#39;</span><span class="p">)</span>

<span class="nb">summary</span><span class="p">({</span>
<span class="w">  </span><span class="s">&#39;Profile&#39;</span><span class="p">:</span><span class="w"> </span><span class="nb">get_option</span><span class="p">(</span><span class="s">&#39;profile&#39;</span><span class="p">),</span>
<span class="p">},</span><span class="w"> </span><span class="n">section</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Development&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The root <code class="docutils literal notranslate"><span class="pre">meson-options.txt</span></code> should have something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;profile&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="s1">&#39;combo&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;development&#39;</span><span class="p">],</span> <span class="n">value</span><span class="p">:</span> <span class="s1">&#39;default&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now under <code class="docutils literal notranslate"><span class="pre">src/meson.build</span></code> or in any subdirectory this can be
specified in a target.</p>
<div class="highlight-meson notranslate"><div class="highlight"><pre><span></span><span class="n">coolapp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">executable</span><span class="p">(</span><span class="s">&#39;coolapp&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;main.c&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nb">include_directories</span><span class="p">:</span><span class="w"> </span><span class="n">configuration_inc</span><span class="p">,</span>
<span class="w">    </span><span class="n">dependencies</span><span class="p">:</span><span class="w"> </span><span class="n">libcoolapp_dep</span><span class="p">,</span>
<span class="w">    </span><span class="n">install</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Now in <code class="docutils literal notranslate"><span class="pre">data/meson.build</span></code>, the icon, desktop file and metainfo file
handling can be specified.</p>
<p>Place a desktop template file called <code class="docutils literal notranslate"><span class="pre">org.example.coolapp.desktop.in.in</span></code>
in <code class="docutils literal notranslate"><span class="pre">data/</span></code> with the contents</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[Desktop Entry]</span>
<span class="na">Name</span><span class="o">=</span><span class="s">Cool App</span>
<span class="na">Exec</span><span class="o">=</span><span class="s">coolapp</span>
<span class="na">Icon</span><span class="o">=</span><span class="s">@icon@</span>
<span class="na">Terminal</span><span class="o">=</span><span class="s">false</span>
<span class="na">Type</span><span class="o">=</span><span class="s">Application</span>
<span class="na">Categories</span><span class="o">=</span><span class="s">Utility</span><span class="c1">;</span>
<span class="na">StartupNotify</span><span class="o">=</span><span class="s">true</span>
</pre></div>
</div>
<p>The corresponding meson bits for the desktop file should be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">desktop_conf</span> <span class="o">=</span> <span class="n">configuration_data</span><span class="p">()</span>
<span class="n">desktop_conf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;icon&#39;</span><span class="p">,</span> <span class="n">application_id</span><span class="p">)</span>
<span class="n">desktop_file</span> <span class="o">=</span> <span class="n">i18n</span><span class="o">.</span><span class="n">merge_file</span><span class="p">(</span>
  <span class="nb">input</span><span class="p">:</span> <span class="n">configure_file</span><span class="p">(</span>
    <span class="nb">input</span><span class="p">:</span> <span class="n">files</span><span class="p">(</span><span class="s1">&#39;org.example.coolapp.desktop.in.in&#39;</span><span class="p">),</span>
    <span class="n">output</span><span class="p">:</span> <span class="s1">&#39;org.example.coolapp.desktop.in&#39;</span><span class="p">,</span>
    <span class="n">configuration</span><span class="p">:</span> <span class="n">desktop_conf</span><span class="p">,</span>
  <span class="p">),</span>
  <span class="n">output</span><span class="p">:</span> <span class="s1">&#39;@0@.desktop&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">application_id</span><span class="p">),</span>
  <span class="nb">type</span><span class="p">:</span> <span class="s1">&#39;desktop&#39;</span><span class="p">,</span>
  <span class="n">po_dir</span><span class="p">:</span> <span class="s1">&#39;../po&#39;</span><span class="p">,</span>
  <span class="n">install</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="n">install_dir</span><span class="p">:</span> <span class="n">get_option</span><span class="p">(</span><span class="s1">&#39;datadir&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="s1">&#39;applications&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">desktop_utils</span> <span class="o">=</span> <span class="n">find_program</span><span class="p">(</span><span class="s1">&#39;desktop-file-validate&#39;</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="n">false</span><span class="p">)</span>
<span class="k">if</span> <span class="n">desktop_utils</span><span class="o">.</span><span class="n">found</span><span class="p">()</span>
  <span class="n">test</span><span class="p">(</span><span class="s1">&#39;Validate desktop file&#39;</span><span class="p">,</span> <span class="n">desktop_utils</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="n">desktop_file</span><span class="p">])</span>
<span class="n">endif</span>
</pre></div>
</div>
<p>Appstream can be handled in the same <code class="docutils literal notranslate"><span class="pre">meson.build</span></code>. Place a metainfo
template file in <code class="docutils literal notranslate"><span class="pre">data/</span></code>. Any tag containing part of the application
ID should be templated. Ususally for desktop applications this involves
only the <code class="docutils literal notranslate"><span class="pre">id</span></code> and <code class="docutils literal notranslate"><span class="pre">launchable</span></code> tag, but the <code class="docutils literal notranslate"><span class="pre">icon</span></code> tag, if present
should also use it.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;component</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;desktop&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;id&gt;</span>@appid@<span class="nt">&lt;/id&gt;</span>
<span class="w">  </span>...
<span class="w">  </span><span class="nt">&lt;launchable</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;desktop-id&quot;</span><span class="nt">&gt;</span>@appid@.desktop<span class="nt">&lt;/launchable&gt;</span>
<span class="w">  </span>...
<span class="nt">&lt;/component&gt;</span>
</pre></div>
</div>
<p>The corresponding meson.build part for metainfo should be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metainfo_conf</span> <span class="o">=</span> <span class="n">configuration_data</span><span class="p">()</span>
<span class="n">metainfo_conf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;appid&#39;</span><span class="p">,</span> <span class="n">application_id</span><span class="p">)</span>
<span class="n">appstream_file</span> <span class="o">=</span> <span class="n">i18n</span><span class="o">.</span><span class="n">merge_file</span><span class="p">(</span>
  <span class="nb">input</span><span class="p">:</span> <span class="n">configure_file</span><span class="p">(</span>
    <span class="nb">input</span><span class="p">:</span> <span class="n">files</span><span class="p">(</span><span class="s1">&#39;org.example.coolapp.metainfo.xml.in.in&#39;</span><span class="p">),</span>
    <span class="n">output</span><span class="p">:</span> <span class="s1">&#39;org.example.coolapp.metainfo.xml.in&#39;</span><span class="p">,</span>
    <span class="n">configuration</span><span class="p">:</span> <span class="n">metainfo_conf</span>
  <span class="p">),</span>
  <span class="n">output</span><span class="p">:</span> <span class="s1">&#39;@0@.metainfo.xml&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">application_id</span><span class="p">),</span>
  <span class="n">po_dir</span><span class="p">:</span> <span class="s1">&#39;../po&#39;</span><span class="p">,</span>
  <span class="n">install</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="n">install_dir</span><span class="p">:</span> <span class="n">get_option</span><span class="p">(</span><span class="s1">&#39;datadir&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="s1">&#39;metainfo&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">appstreamcli</span> <span class="o">=</span> <span class="n">find_program</span><span class="p">(</span><span class="s1">&#39;appstreamcli&#39;</span><span class="p">,</span> <span class="n">required</span><span class="p">:</span> <span class="n">false</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">appstreamcli</span><span class="o">.</span><span class="n">found</span><span class="p">())</span>
  <span class="n">test</span><span class="p">(</span><span class="s1">&#39;Validate metainfo file&#39;</span><span class="p">,</span>
    <span class="n">appstreamcli</span><span class="p">,</span>
    <span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;validate&#39;</span><span class="p">,</span> <span class="s1">&#39;--no-net&#39;</span><span class="p">,</span> <span class="s1">&#39;--explain&#39;</span><span class="p">,</span> <span class="n">appstream_file</span><span class="p">],</span>
    <span class="n">workdir</span><span class="p">:</span> <span class="n">meson</span><span class="o">.</span><span class="n">current_build_dir</span><span class="p">()</span>
  <span class="p">)</span>
<span class="n">endif</span>
</pre></div>
</div>
<p>Finally icons can be placed in <code class="docutils literal notranslate"><span class="pre">data/icons/hicolor/{scalable,</span> <span class="pre">symbolic}/apps</span></code>.
Two icons should be provided <code class="docutils literal notranslate"><span class="pre">org.example.coolapp.svg</span></code> and <code class="docutils literal notranslate"><span class="pre">org.example.coolapp.Devel.svg</span></code>.
The meson.build should have</p>
<div class="highlight-meson notranslate"><div class="highlight"><pre><span></span><span class="n">icondir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">join_paths</span><span class="p">(</span><span class="s">&#39;icons&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;hicolor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;scalable&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;apps&#39;</span><span class="p">)</span>
<span class="nb">install_data</span><span class="p">(</span>
<span class="w">  </span><span class="nb">join_paths</span><span class="p">(</span><span class="n">icondir</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;@0@.svg&#39;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">application_id</span><span class="p">)),</span>
<span class="w">  </span><span class="n">install_dir</span><span class="p">:</span><span class="w"> </span><span class="nb">join_paths</span><span class="p">(</span><span class="n">datadir</span><span class="p">,</span><span class="w"> </span><span class="n">icondir</span><span class="p">),</span>
<span class="w">  </span><span class="n">rename</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;@0@.svg&#39;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">application_id</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">icondir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">join_paths</span><span class="p">(</span><span class="s">&#39;icons&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;hicolor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;symbolic&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;apps&#39;</span><span class="p">)</span>
<span class="nb">install_data</span><span class="p">(</span>
<span class="w">  </span><span class="nb">join_paths</span><span class="p">(</span><span class="n">icondir</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;org.example.coolapp-symbolic.svg&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="n">install_dir</span><span class="p">:</span><span class="w"> </span><span class="nb">join_paths</span><span class="p">(</span><span class="n">datadir</span><span class="p">,</span><span class="w"> </span><span class="n">icondir</span><span class="p">),</span>
<span class="w">  </span><span class="n">rename</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;@0@-symbolic.svg&#39;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">application_id</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Any gschemea file should also be similarly handled if present.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">install_data</span><span class="p">(</span><span class="s1">&#39;org.example.coolapp.gschema.xml&#39;</span><span class="p">,</span>
  <span class="n">rename</span><span class="p">:</span> <span class="s1">&#39;@0@.gschema.xml&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">application_id</span><span class="p">),</span>
  <span class="n">install_dir</span><span class="p">:</span> <span class="n">get_option</span><span class="p">(</span><span class="s1">&#39;datadir&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="s1">&#39;glib-2.0&#39;</span> <span class="o">/</span> <span class="s1">&#39;schemas&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Any dbus service file if present should be handled. The <code class="docutils literal notranslate"><span class="pre">org.example.coolapp.service.in</span></code>
should have <code class="docutils literal notranslate"><span class="pre">Name=&#64;appid&#64;</span></code></p>
<div class="highlight-meson notranslate"><div class="highlight"><pre><span></span><span class="n">service_conf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">configuration_data</span><span class="p">()</span>
<span class="n">service_conf</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;appid&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">application_id</span><span class="p">)</span>
<span class="n">service_conf</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;bindir&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">join_paths</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span><span class="w"> </span><span class="n">bindir</span><span class="p">))</span>
<span class="nb">configure_file</span><span class="p">(</span>
<span class="w">  </span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;org.example.coolapp.service.in&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="n">output</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;@0@.service&#39;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">application_id</span><span class="p">),</span>
<span class="w">  </span><span class="n">configuration</span><span class="p">:</span><span class="w"> </span><span class="n">service_conf</span><span class="p">,</span>
<span class="w">  </span><span class="n">install_dir</span><span class="p">:</span><span class="w"> </span><span class="n">servicedir</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The same pattern can be used for search provider files if present.
The <code class="docutils literal notranslate"><span class="pre">org.example.coolapp.service.ini.in</span></code> should look like</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">DesktopId</span><span class="o">=</span><span class="s">@appid@.desktop</span>
<span class="na">BusName</span><span class="o">=</span><span class="s">@appid@</span>
<span class="na">ObjectPath</span><span class="o">=</span><span class="s">/org/gnome/AppName@profile@/SearchProvider</span>
</pre></div>
</div>
<p>and the corresponding meson.build:</p>
<div class="highlight-meson notranslate"><div class="highlight"><pre><span></span><span class="n">search_provider_conf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">configuration_data</span><span class="p">()</span>
<span class="n">search_provider_conf</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;appid&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">application_id</span><span class="p">)</span>
<span class="n">search_provider_conf</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;profile&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">profile</span><span class="p">)</span>
<span class="nb">configure_file</span><span class="p">(</span>
<span class="w">  </span><span class="n">configuration</span><span class="p">:</span><span class="w"> </span><span class="n">search_provider_conf</span><span class="p">,</span>
<span class="w">  </span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="nb">files</span><span class="p">(</span><span class="s">&#39;org.example.coolapp.service.ini.in&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="n">install_dir</span><span class="p">:</span><span class="w"> </span><span class="nb">join_paths</span><span class="p">(</span><span class="n">datadir</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;gnome-shell&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;search-providers&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="n">output</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;@0@.search-provider.ini&#39;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">application_id</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="application-handling">
<h3>Application handling<a class="headerlink" href="#application-handling" title="Link to this heading">🔗</a></h3>
<p>The correct application ID must be supplied when initiating the
application. For example in <code class="docutils literal notranslate"><span class="pre">main.c</span></code></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;config.h&quot;</span>

<span class="p">...</span>

<span class="kt">int</span>
<span class="n">main</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>

<span class="w">  </span><span class="p">...</span>

<span class="w">  </span><span class="n">g_set_prgname</span><span class="w"> </span><span class="p">(</span><span class="n">APPLICATION_ID</span><span class="p">);</span>
<span class="w">  </span><span class="n">gtk_window_set_default_icon_name</span><span class="w"> </span><span class="p">(</span><span class="n">APPLICATION_ID</span><span class="p">);</span>

<span class="w">  </span><span class="n">coolapp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_object_new</span><span class="w"> </span><span class="p">(</span><span class="n">APP_NAME_TYPE_APPLICATION</span><span class="p">,</span>
<span class="w">                          </span><span class="s">&quot;application-id&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">APPLICATION_ID</span><span class="p">,</span>
<span class="w">                          </span><span class="s">&quot;flags&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">G_APPLICATION_HANDLES_OPEN</span><span class="p">,</span>
<span class="w">                          </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">  </span><span class="n">g_application_run</span><span class="w"> </span><span class="p">(</span><span class="n">G_APPLICATION</span><span class="w"> </span><span class="p">(</span><span class="n">coolapp</span><span class="p">),</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Similarly it can be handled in the about dialogue of the application and
elsewhere.</p>
</section>
<section id="manifest-handling">
<h3>Manifest handling<a class="headerlink" href="#manifest-handling" title="Link to this heading">🔗</a></h3>
<p>Finally there must be two manifests for Devel and stable - <code class="docutils literal notranslate"><span class="pre">org.example.coolapp.Devel.yaml</span></code>
and <code class="docutils literal notranslate"><span class="pre">org.example.coolapp.yaml</span></code> respectively.</p>
<p>The manifest must have the correct <code class="docutils literal notranslate"><span class="pre">id</span></code> property. The devel manifest
should use <code class="docutils literal notranslate"><span class="pre">id:</span> <span class="pre">org.example.coolapp.Devel</span></code> and the stable manifest
should use <code class="docutils literal notranslate"><span class="pre">id:</span> <span class="pre">org.example.coolapp</span></code>.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">config-opts</span></code> for the application module, <code class="docutils literal notranslate"><span class="pre">-Dprofile=Devel</span></code> can be
passed to build the Devel application.</p>
<p>In case, buildsystem handling for desktop file, icon and metainfo file
is absent <code class="docutils literal notranslate"><span class="pre">rename-desktop-file,</span> <span class="pre">rename-appdata-file,</span> <span class="pre">rename-mime-file,</span> <span class="pre">rename-icon</span></code>
can be used rename the files to match the <code class="docutils literal notranslate"><span class="pre">.Devel</span></code> application ID.</p>
<p><code class="docutils literal notranslate"><span class="pre">desktop-file-name-prefix</span></code> or <code class="docutils literal notranslate"><span class="pre">desktop-file-name-suffix</span></code> can be used
to add a prefix or suffix to the desktop file name respectively.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">org.example.coolapp.Devel</span>
<span class="nn">...</span>
<span class="nt">rename-desktop-file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">org.example.coolapp.desktop</span>
<span class="nt">rename-appdata-file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">org.example.coolapp.metainfo.xml</span>
<span class="nt">rename-icon</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">org.example.coolapp</span>
<span class="nt">desktop-file-name-suffix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;</span><span class="nv"> </span><span class="s">(Nightly)&#39;</span>
</pre></div>
</div>
<p>The main drawback of modifying it in place with Flatpak Builder is that,
the application ID, D-Bus names and configuration location cannot be
changed. This might cause integration issues with desktop environment,
potential configuration conflicts, or the application might not run in
some cases when the D-Bus name is already in use. This would prevent
running the stable and nightly applications parallely.</p>
<p>In case the application ID remains static, for GTK based applications
the <code class="docutils literal notranslate"><span class="pre">--name</span></code> flag can be passed to the main binary with the correct
application ID; <code class="docutils literal notranslate"><span class="pre">--class</span></code> and <code class="docutils literal notranslate"><span class="pre">StartupWMClass</span></code> in the
desktop file to fix the window class.</p>
</section>
</section>
<section id="additional-tools">
<h2>Additional tools<a class="headerlink" href="#additional-tools" title="Link to this heading">🔗</a></h2>
<ul>
<li><p><a class="reference external" href="https://www.electron.build/flatpak.html">Electron Builder</a>
supports exporting single file Flatpak bundles. Please also see the
Electron application packaging guide <a class="reference internal" href="electron.html"><span class="doc">Electron</span></a>.</p></li>
<li><p><a class="reference external" href="https://apps.gnome.org/Builder/">GNOME Builder</a> is an IDE that can
integrate with the development workflow of GNOME applications.
<a class="reference external" href="https://flathub.org/apps/io.qt.QtCreator">Qt Creator</a> and <a class="reference external" href="https://flathub.org/apps/io.qt.qtdesignstudio">Qt Design Studio</a>
are both available as Flatpaks from Flathub along with a variety of
IDEs.</p></li>
<li><p><a class="reference external" href="https://gitlab.com/freedesktop-sdk/freedesktop-sdk/-/wikis/Freedesktop-SDK-Flatpak-repository">Freedesktop SDK</a>
and <a class="reference external" href="https://nightly.gnome.org/">GNOME Nightly</a> hosts nightly
versions of the <code class="docutils literal notranslate"><span class="pre">org.freedesktop.Platform</span></code> and <code class="docutils literal notranslate"><span class="pre">org.gnome.Platform</span></code>
runtimes and SDKs.</p>
<p><a class="reference external" href="https://os.gnome.org/">GNOME OS</a> is an immutable Flatpak first system
that can also be used to build and test applications on upcoming
GNOME versions.</p>
</li>
<li><p>Freedesktop SDK also builds Mesa from the git main branch. Please see
the <a class="reference external" href="https://gitlab.com/freedesktop-sdk/freedesktop-sdk/-/wikis/mesa-git">docs</a>
on how to use that.</p></li>
<li><p><a class="reference external" href="https://github.com/flathub?q=org.freedesktop.Sdk.Extension&amp;type=all&amp;language=&amp;sort=">Flathub hosts</a>
extensions for lots of tooling and languages that can be used to build
applications.</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="tips-and-tricks.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tips and Tricks</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="portals.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Portal support in GTK</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2017-2025, Flatpak Team. Licensed under Creative Commons Attribution 4.0 International License.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Flatpak as a developer platform</a><ul>
<li><a class="reference internal" href="#ci-integration">CI Integration</a></li>
<li><a class="reference internal" href="#running-tests">Running tests</a></li>
<li><a class="reference internal" href="#parallel-nightly-and-stable-applications">Parallel nightly and stable applications</a><ul>
<li><a class="reference internal" href="#buildsystem-handling">Buildsystem handling</a></li>
<li><a class="reference internal" href="#application-handling">Application handling</a></li>
<li><a class="reference internal" href="#manifest-handling">Manifest handling</a></li>
</ul>
</li>
<li><a class="reference internal" href="#additional-tools">Additional tools</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=7d86a446"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/translations.js?v=beaddf03"></script>
    </body>
</html>